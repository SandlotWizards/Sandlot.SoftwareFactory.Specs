# ğŸ§  Command-Service Pipeline Design Spec

## âš  Canonical Enforcement Notice
This document defines a **canonical design specification** for the `Command-Service` AI Pipeline.  
Use of this document is **mandatory** for any implementation, execution, or interpretation of this pipeline.  
All sections must be completed clearly and consistently to enable AI-driven decomposition and reliable software generation.

---

## ğŸ“˜ Purpose
This pipeline creates a pair of classes that follow the command-service design pattern, consisting of a Command and a CommandHandler.  
These components are the foundational building blocks for all pipelines and tools produced within the Software Factory.

---

## ğŸ—‚ Scope
This specification applies to all CLI-triggered or pipeline-generated command-service class pairs used in AI Pipelines, SoftwareFactory, and DeploymentFactory.

---

## ğŸ“¥ Inputs
```yaml
- name: CommandName
  type: string
  required: true
  description: PascalCase name for the command (e.g., CreateUser)
- name: Description
  type: string
  required: false
  description: Optional human-readable summary of the command's intent
```

---

## ğŸ“¤ Outputs
- `{CommandName}Command.cs`
- `{CommandName}CommandHandler.cs`
- Optional test suite (generated separately)
- CLI registration snippet
- **Each generated service includes structured logging via `ActionLog.Global.BeginStep(...)` per the logging standard**

---

## ğŸ” Processing Flow
1. Parse inputs
2. Generate `Command` class from template
3. Generate `CommandHandler` using AI contract
4. Generate service class and SRP partials with scoped logging steps
5. Optionally inject CLI registration
6. Optionally trigger test suite generation

---

## ğŸ”§ Decomposed Design
- Command class file â†’ from static template
- Handler class file â†’ from AI contract + handler template
- CLI registration snippet â†’ inject into LoreCommandRegistration.cs
- Optional test suite â†’ generated by TestSuiteGenerator pipeline

---

## ğŸš€ Design Action Plan
- `create-command-service --name {CommandName}`
- `generate-handler --from {CommandName} --ai`
- `inject-cli-registration --command {CommandName}`
- `gen-tests --sut {CommandName}CommandHandler`

---

## ğŸ¤– AI Contracts Needed
- `HandlerPrompt` â†’ generate handler logic
- `CommandSummaryPrompt` â†’ generate XML docs and help text

---

## ğŸ”— Dependencies
- Requires `TemplateInjectionPipeline`
- Depends on `LoreCommandRegistration.cs`, `ILogger`, `ICommand`
- Assumes `ActionLog.Global` is initialized in the host environment

---

## âœ… Validation & Quality Checks
- Command and handler compile without errors
- No empty methods or TODOs
- New command is discoverable in CLI help output
- Orchestrator and partials include scoped logging via `BeginStep(...)`

---

## ğŸ§ª Examples
TBD in later versions
